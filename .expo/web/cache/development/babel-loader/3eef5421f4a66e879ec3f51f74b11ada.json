{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.propsFlattener = exports.compareSpecificity = void 0;\n\nvar _extends3 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash.merge\"));\n\nvar _INITIAL_PROP_SPECIFI;\n\nvar SPECIFICITY_100 = 100;\nvar SPECIFICITY_70 = 70;\nvar SPECIFICITY_60 = 60;\nvar SPECIFICITY_55 = 55;\nvar SPECIFICITY_50 = 50;\nvar SPECIFICITY_40 = 40;\nvar SPECIFICITY_30 = 30;\nvar SPECIFICITY_10 = 10;\nvar SPECIFICITY_1 = 1;\nvar specificityPrecedence = [SPECIFICITY_100, SPECIFICITY_70, SPECIFICITY_60, SPECIFICITY_55, SPECIFICITY_50, SPECIFICITY_40, SPECIFICITY_30, SPECIFICITY_10, SPECIFICITY_1];\nvar INITIAL_PROP_SPECIFICITY = (_INITIAL_PROP_SPECIFI = {}, (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_100, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_70, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_60, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_50, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_55, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_40, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_30, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_10, 0), (0, _defineProperty2.default)(_INITIAL_PROP_SPECIFI, SPECIFICITY_1, 0), _INITIAL_PROP_SPECIFI);\nvar pseudoPropsMap = {\n  _web: {\n    dependentOn: 'platform',\n    priority: SPECIFICITY_10\n  },\n  _ios: {\n    dependentOn: 'platform',\n    priority: SPECIFICITY_10\n  },\n  _android: {\n    dependentOn: 'platform',\n    priority: SPECIFICITY_10\n  },\n  _light: {\n    dependentOn: 'colormode',\n    priority: SPECIFICITY_10\n  },\n  _dark: {\n    dependentOn: 'colormode',\n    priority: SPECIFICITY_10\n  },\n  _indeterminate: {\n    dependentOn: 'state',\n    respondTo: 'isIndeterminate',\n    priority: SPECIFICITY_30\n  },\n  _checked: {\n    dependentOn: 'state',\n    respondTo: 'isChecked',\n    priority: SPECIFICITY_30\n  },\n  _readOnly: {\n    dependentOn: 'state',\n    respondTo: 'isReadOnly',\n    priority: SPECIFICITY_30\n  },\n  _invalid: {\n    dependentOn: 'state',\n    respondTo: 'isInvalid',\n    priority: SPECIFICITY_40\n  },\n  _focus: {\n    dependentOn: 'state',\n    respondTo: 'isFocused',\n    priority: SPECIFICITY_50\n  },\n  _focusVisible: {\n    dependentOn: 'state',\n    respondTo: 'isFocusVisible',\n    priority: SPECIFICITY_55\n  },\n  _hover: {\n    dependentOn: 'state',\n    respondTo: 'isHovered',\n    priority: SPECIFICITY_60\n  },\n  _pressed: {\n    dependentOn: 'state',\n    respondTo: 'isPressed',\n    priority: SPECIFICITY_70\n  },\n  _disabled: {\n    dependentOn: 'state',\n    respondTo: 'isDisabled',\n    priority: SPECIFICITY_100\n  }\n};\n\nvar compareSpecificity = function compareSpecificity(exisiting, upcoming, ignorebaseTheme) {\n  if (!exisiting) return true;\n  if (!upcoming) return false;\n  var condition = ignorebaseTheme ? specificityPrecedence.length - 1 : specificityPrecedence.length;\n\n  for (var index = 0; index < condition; index++) {\n    if (exisiting[specificityPrecedence[index]] > upcoming[specificityPrecedence[index]]) {\n      return false;\n    } else if (exisiting[specificityPrecedence[index]] < upcoming[specificityPrecedence[index]]) {\n      return true;\n    }\n  }\n\n  return true;\n};\n\nexports.compareSpecificity = compareSpecificity;\n\nvar shouldResolvePseudoProp = function shouldResolvePseudoProp(_ref) {\n  var property = _ref.property,\n      state = _ref.state,\n      platform = _ref.platform,\n      colormode = _ref.colormode;\n\n  if (pseudoPropsMap[property].dependentOn === 'platform') {\n    return property === \"_\" + platform;\n  } else if (pseudoPropsMap[property].dependentOn === 'colormode') {\n    return property === \"_\" + colormode;\n  } else if (pseudoPropsMap[property].dependentOn === 'state') {\n    return state[pseudoPropsMap[property].respondTo];\n  } else {\n    return false;\n  }\n};\n\nvar simplifyProps = function simplifyProps(_ref2) {\n  var props = _ref2.props,\n      colormode = _ref2.colormode,\n      platform = _ref2.platform,\n      state = _ref2.state,\n      currentSpecificity = _ref2.currentSpecificity,\n      previouslyFlattenProps = _ref2.previouslyFlattenProps;\n  var flattenProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var specificityMap = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var priority = arguments.length > 3 ? arguments[3] : undefined;\n\n  for (var property in props) {\n    var _pseudoPropsMap$prope, _pseudoPropsMap$prope2;\n\n    var propertySpecity = currentSpecificity ? (0, _extends3.default)({}, currentSpecificity) : (0, _extends3.default)({}, INITIAL_PROP_SPECIFICITY, (0, _defineProperty2.default)({}, SPECIFICITY_1, priority));\n\n    if (state[(_pseudoPropsMap$prope = pseudoPropsMap[property]) == null ? void 0 : _pseudoPropsMap$prope.respondTo] || ['_dark', '_light', '_web', '_ios', '_android'].includes(property)) {\n      if (shouldResolvePseudoProp({\n        property: property,\n        state: state,\n        platform: platform,\n        colormode: colormode\n      })) {\n        propertySpecity[pseudoPropsMap[property].priority]++;\n        simplifyProps({\n          props: props[property],\n          colormode: colormode,\n          platform: platform,\n          state: state,\n          currentSpecificity: propertySpecity,\n          previouslyFlattenProps: previouslyFlattenProps\n        }, flattenProps, specificityMap, priority);\n      }\n    } else if (state[(_pseudoPropsMap$prope2 = pseudoPropsMap[property]) == null ? void 0 : _pseudoPropsMap$prope2.respondTo] === undefined) {\n      if (property.startsWith('_')) {\n        if (compareSpecificity(specificityMap[property], propertySpecity, false)) {\n          specificityMap[property] = propertySpecity;\n          flattenProps[property] = (0, _lodash.default)({}, flattenProps[property], props[property]);\n        } else {\n          flattenProps[property] = (0, _lodash.default)({}, props[property], flattenProps[property]);\n        }\n      } else {\n        if (compareSpecificity(specificityMap[property], propertySpecity, false)) {\n          specificityMap[property] = propertySpecity;\n          flattenProps[property] = props[property];\n        }\n      }\n    }\n  }\n};\n\nvar propsFlattener = function propsFlattener(_ref3, priority) {\n  var props = _ref3.props,\n      colormode = _ref3.colormode,\n      platform = _ref3.platform,\n      state = _ref3.state,\n      currentSpecificityMap = _ref3.currentSpecificityMap,\n      previouslyFlattenProps = _ref3.previouslyFlattenProps;\n  var flattenProps = {};\n\n  for (var property in props) {\n    var _pseudoPropsMap$prope3;\n\n    if (state[(_pseudoPropsMap$prope3 = pseudoPropsMap[property]) == null ? void 0 : _pseudoPropsMap$prope3.respondTo] === undefined && property.startsWith('_')) {\n      flattenProps[property] = previouslyFlattenProps[property];\n    }\n  }\n\n  var specificityMap = currentSpecificityMap || {};\n  simplifyProps({\n    props: props,\n    colormode: colormode,\n    platform: platform,\n    state: state,\n    currentSpecificityMap: currentSpecificityMap,\n    previouslyFlattenProps: previouslyFlattenProps\n  }, flattenProps, specificityMap, priority);\n  return [flattenProps, specificityMap];\n};\n\nexports.propsFlattener = propsFlattener;","map":{"version":3,"sources":["propsFlattenerTest.tsx"],"names":["SPECIFICITY_100","SPECIFICITY_70","SPECIFICITY_60","SPECIFICITY_55","SPECIFICITY_50","SPECIFICITY_40","SPECIFICITY_30","SPECIFICITY_10","SPECIFICITY_1","specificityPrecedence","INITIAL_PROP_SPECIFICITY","pseudoPropsMap","_web","dependentOn","priority","_ios","_android","_light","_dark","_indeterminate","respondTo","_checked","_readOnly","_invalid","_focus","_focusVisible","_hover","_pressed","_disabled","compareSpecificity","condition","ignorebaseTheme","index","exisiting","upcoming","shouldResolvePseudoProp","property","state","platform","colormode","simplifyProps","props","currentSpecificity","previouslyFlattenProps","flattenProps","specificityMap","propertySpecity","propsFlattener","currentSpecificityMap"],"mappings":"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","sourcesContent":["import merge from 'lodash.merge';\n\nconst SPECIFICITY_100 = 100;\nconst SPECIFICITY_70 = 70;\nconst SPECIFICITY_60 = 60;\nconst SPECIFICITY_55 = 55;\nconst SPECIFICITY_50 = 50;\nconst SPECIFICITY_40 = 40;\nconst SPECIFICITY_30 = 30;\nconst SPECIFICITY_10 = 10;\nconst SPECIFICITY_1 = 1;\nconst specificityPrecedence = [\n  SPECIFICITY_100,\n  SPECIFICITY_70,\n  SPECIFICITY_60,\n  SPECIFICITY_55,\n  SPECIFICITY_50,\n  SPECIFICITY_40,\n  SPECIFICITY_30,\n  SPECIFICITY_10,\n  SPECIFICITY_1,\n];\nconst INITIAL_PROP_SPECIFICITY = {\n  [SPECIFICITY_100]: 0,\n  [SPECIFICITY_70]: 0,\n  [SPECIFICITY_60]: 0,\n  [SPECIFICITY_50]: 0,\n  [SPECIFICITY_55]: 0,\n  [SPECIFICITY_40]: 0,\n  [SPECIFICITY_30]: 0,\n  [SPECIFICITY_10]: 0,\n  [SPECIFICITY_1]: 0,\n};\n\nconst pseudoPropsMap: any = {\n  _web: { dependentOn: 'platform', priority: SPECIFICITY_10 },\n  _ios: { dependentOn: 'platform', priority: SPECIFICITY_10 },\n  _android: { dependentOn: 'platform', priority: SPECIFICITY_10 },\n\n  _light: { dependentOn: 'colormode', priority: SPECIFICITY_10 },\n  _dark: { dependentOn: 'colormode', priority: SPECIFICITY_10 },\n\n  // TODO: have to add more interactionProps and stateProps\n  _indeterminate: {\n    dependentOn: 'state',\n    respondTo: 'isIndeterminate',\n    priority: SPECIFICITY_30,\n  },\n  _checked: {\n    dependentOn: 'state',\n    respondTo: 'isChecked',\n    priority: SPECIFICITY_30,\n  },\n  // Add new pseudeo props in between -------\n  _readOnly: {\n    dependentOn: 'state',\n    respondTo: 'isReadOnly',\n    priority: SPECIFICITY_30,\n  },\n  // Add new pseudeo props in between -------\n  _invalid: {\n    dependentOn: 'state',\n    respondTo: 'isInvalid',\n    priority: SPECIFICITY_40,\n  },\n  _focus: {\n    dependentOn: 'state',\n    respondTo: 'isFocused',\n    priority: SPECIFICITY_50,\n  },\n  _focusVisible: {\n    dependentOn: 'state',\n    respondTo: 'isFocusVisible',\n    priority: SPECIFICITY_55,\n  },\n  _hover: {\n    dependentOn: 'state',\n    respondTo: 'isHovered',\n    priority: SPECIFICITY_60,\n  },\n  _pressed: {\n    dependentOn: 'state',\n    respondTo: 'isPressed',\n    priority: SPECIFICITY_70,\n  },\n  _disabled: {\n    dependentOn: 'state',\n    respondTo: 'isDisabled',\n    priority: SPECIFICITY_100,\n  },\n};\n\nexport const compareSpecificity = (\n  exisiting: any,\n  upcoming: any,\n  ignorebaseTheme?: boolean\n  // property?: any\n) => {\n  if (!exisiting) return true;\n  if (!upcoming) return false;\n  const condition = ignorebaseTheme\n    ? specificityPrecedence.length - 1\n    : specificityPrecedence.length;\n  for (let index = 0; index < condition; index++) {\n    if (\n      exisiting[specificityPrecedence[index]] >\n      upcoming[specificityPrecedence[index]]\n    ) {\n      return false;\n    } else if (\n      exisiting[specificityPrecedence[index]] <\n      upcoming[specificityPrecedence[index]]\n    ) {\n      return true;\n    }\n  }\n  return true;\n};\n\nconst shouldResolvePseudoProp = ({\n  property,\n  state,\n  platform,\n  colormode,\n}: any) => {\n  if (pseudoPropsMap[property].dependentOn === 'platform') {\n    return property === `_${platform}`;\n  } else if (pseudoPropsMap[property].dependentOn === 'colormode') {\n    return property === `_${colormode}`;\n  } else if (pseudoPropsMap[property].dependentOn === 'state') {\n    return state[pseudoPropsMap[property].respondTo];\n  } else {\n    return false;\n  }\n};\n\nconst simplifyProps = (\n  {\n    props,\n    colormode,\n    platform,\n    state,\n    currentSpecificity,\n    previouslyFlattenProps,\n  }: any,\n  flattenProps: any = {},\n  specificityMap: any = {},\n  priority: number\n) => {\n  for (const property in props) {\n    // NOTE: the order is important here. Keep in mind while specificity breakpoints.\n    const propertySpecity = currentSpecificity\n      ? { ...currentSpecificity }\n      : {\n          ...INITIAL_PROP_SPECIFICITY,\n          [SPECIFICITY_1]: priority,\n        };\n\n    if (\n      state[pseudoPropsMap[property]?.respondTo] ||\n      ['_dark', '_light', '_web', '_ios', '_android'].includes(property)\n    ) {\n      if (shouldResolvePseudoProp({ property, state, platform, colormode })) {\n        propertySpecity[pseudoPropsMap[property].priority]++;\n\n        simplifyProps(\n          {\n            props: props[property],\n            colormode,\n            platform,\n            state,\n            currentSpecificity: propertySpecity,\n            previouslyFlattenProps: previouslyFlattenProps,\n          },\n          flattenProps,\n          specificityMap,\n          priority\n        );\n      }\n    } else if (state[pseudoPropsMap[property]?.respondTo] === undefined) {\n      if (property.startsWith('_')) {\n        if (\n          compareSpecificity(specificityMap[property], propertySpecity, false)\n        ) {\n          specificityMap[property] = propertySpecity;\n          // merging internal props (like, _text, _checked, ...)\n          flattenProps[property] = merge(\n            {},\n            flattenProps[property],\n            props[property]\n          );\n        } else {\n          flattenProps[property] = merge(\n            {},\n            props[property],\n            flattenProps[property]\n          );\n        }\n      } else {\n        if (\n          compareSpecificity(specificityMap[property], propertySpecity, false)\n        ) {\n          specificityMap[property] = propertySpecity;\n          // replacing simple props (like, p, m, bg, color, ...)\n          flattenProps[property] = props[property];\n        }\n      }\n    }\n  }\n};\n\nexport const propsFlattener = (\n  {\n    props,\n    colormode,\n    platform,\n    state,\n    currentSpecificityMap,\n    previouslyFlattenProps,\n  }: any,\n  priority: number\n) => {\n  const flattenProps: any = {};\n\n  for (const property in props) {\n    if (\n      state[pseudoPropsMap[property]?.respondTo] === undefined &&\n      property.startsWith('_')\n    ) {\n      flattenProps[property] = previouslyFlattenProps[property];\n    }\n  }\n\n  const specificityMap = currentSpecificityMap || {};\n\n  // STEP 1.a (if): Check weather it should be recursively resolved\n  // NOTE: (when true) recursively resolved it\n  // STEP 1.b (else if): Check specificty\n  // STEP 1.b.i: Check for pseudo props\n  // NOTE: (when true) Merge it.\n  // NOTE: (when false) Replace it.\n\n  simplifyProps(\n    {\n      props,\n      colormode,\n      platform,\n      state,\n      currentSpecificityMap,\n      previouslyFlattenProps,\n    },\n    flattenProps,\n    specificityMap,\n    priority\n  );\n\n  return [flattenProps, specificityMap];\n};\n"]},"metadata":{},"sourceType":"script"}